(function(){var a=function(e){var d=Array.prototype.slice.call(arguments,1);for(var c=0,b=d.length;c<b;c++){for(var f in d[c]){e[f]=d[c][f]}}return e};this.janky=function(e){var b=janky._form();var c=b[0];var d=b[1];a({},janky._default_opts,e);if(!e.url){throw new Error("Must include a URL to send data to.")}d.setAttribute("action",e.url);d.setAttribute("method",e.method);a(e.data,{_origin:location.href});janky._input(d,e.data);c.onload=function(){setTimeout(function(){document.body.removeChild(c)},1);if(!c.contentWindow.location.href){return e.error&&e.error()}var f=c.contentWindow.name;e.success&&e.success(JSON.parse(f))};d.submit()};this.janky._form=function(){var b=document.createElement("iframe");document.body.appendChild(b);b.style.display="none";var c=document.createElement("form");b.contentDocument.body.appendChild(c);return[b,c]};this.janky._default_opts={method:"get"};this.janky.is_string=function(b){return !!(b===""||(b&&b.charCodeAt&&b.substr))};this.janky._input=function(d,e){for(var b in e){var f=e[b];if(!janky.is_string(f)){f=JSON.stringify(f)}var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name",b);c.value=f;d.appendChild(c)}}})();